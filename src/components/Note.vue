<template>
    <div class="note bc" :class="color" :id="id">
        <span class="corner-color" :class="color"></span>
        <div class="text-note">
            {{ title }}
        </div>
        <div v-if="isCompleted" class="completed">
            <svg xmlns="http://www.w3.org/2000/svg" id="Layer_1" enable-background="new 0 0 512.001 512.001" viewBox="0 0 512.001 512.001" width="35px"><g><g clip-rule="evenodd" fill-rule="evenodd"><path d="m278.686 168.547 48.812-48.812c7.809-7.809 7.809-20.472 0-28.281-7.809-7.81-20.472-7.81-28.281 0l-34.671 34.671-11.761-11.761c-7.809-7.809-20.472-7.809-28.281 0s-7.809 20.472 0 28.281l25.902 25.902c7.808 7.809 20.471 7.809 28.28 0z" fill="#fff"/><path d="m327.498 119.735-48.812 48.812c-7.809 7.809-20.472 7.809-28.281 0l-25.902-25.902c-7.809-7.809-7.809-20.472 0-28.281s20.472-7.809 28.281 0l11.761 11.761 34.671-34.671c7.809-7.81 20.472-7.81 28.281 0 7.81 7.809 7.81 20.471.001 28.281zm-51.497-109.735c-66.275 0-120.001 53.726-120.001 120 0 58.55 41.933 107.307 97.404 117.876 7.318 1.394 14.872 2.124 22.596 2.124s15.278-.73 22.596-2.124c55.472-10.57 97.404-59.326 97.404-117.876.001-66.274-53.725-120-119.999-120z" fill="#cbe558"/><path d="m298.597 247.876c-7.318 1.394-14.872 2.124-22.596 2.124s-15.278-.73-22.596-2.124v63.176 10.178h45.193v-73.354z" fill="#6d91ac"/><path d="m298.597 321.231h-45.193v-10.178h-11.659c-28.996 0-55.019 12.993-72.543 33.523h-53.201l.07 123.902h53.175c17.547 20.486 43.575 33.523 72.499 33.523l102.501.001c12.417 0 22.596-10.17 22.596-22.597 0-12.428-10.168-22.597-22.596-22.597h15.405c12.421 0 22.594-10.173 22.594-22.596 0-12.428-10.166-22.595-22.594-22.595h8.577c12.423 0 22.597-10.169 22.597-22.598 0-12.428-10.169-22.596-22.597-22.596h-16.281c12.424 0 22.597-10.172 22.597-22.597 0-12.426-10.169-22.596-22.597-22.596h-53.35z" fill="#ffdcd5"/></g><g><path d="m400.825 389.02c0-13.513-8.266-25.132-20.006-30.067 2.379-4.523 3.727-9.671 3.727-15.126 0-17.973-14.623-32.596-32.598-32.596h-43.352v-55.37c55.959-14.501 97.405-65.431 97.405-125.861 0-71.682-58.317-130-130-130-17.912 0-35.276 3.586-51.61 10.659-5.068 2.194-7.397 8.082-5.203 13.15s8.085 7.399 13.15 5.203c13.81-5.98 28.501-9.012 43.663-9.012 60.654 0 110 49.346 110 110s-49.346 110-110 110-110.001-49.346-110.001-110c0-15.167 3.033-29.858 9.015-43.668 2.195-5.068-.133-10.956-5.201-13.151-5.065-2.195-10.956.133-13.15 5.202-7.076 16.333-10.664 33.7-10.664 51.617 0 60.43 41.446 111.359 97.404 125.861v45.191h-1.658c-29.281 0-57.09 12.161-77.019 33.523h-48.727c-2.653 0-5.197 1.054-7.073 2.931-1.875 1.876-2.929 4.421-2.927 7.075l.07 123.902c.003 5.521 4.479 9.994 10 9.994h48.709c19.982 21.363 47.772 33.523 76.967 33.523l102.5.001c17.974 0 32.597-14.623 32.597-32.597 0-5.581-1.409-10.837-3.891-15.435 11.361-5.098 19.293-16.519 19.293-29.757 0-6.774-2.077-13.072-5.627-18.291 8.572-5.877 14.207-15.744 14.207-26.901zm-124.824-129.02c4.249 0 8.45-.212 12.596-.612v51.843h-25.192v-.179-51.664c4.145.401 8.346.612 12.596.612zm92.227 141.618h-8.577c-5.522 0-10 4.477-10 10s4.478 10 10 10c6.944 0 12.594 5.65 12.594 12.595s-5.649 12.596-12.594 12.596h-15.405c-5.522 0-10 4.477-10 10 0 5.522 4.477 10 10 10 6.946 0 12.597 5.651 12.597 12.597s-5.65 12.597-12.597 12.597l-102.5-.003c-24.902 0-48.559-10.945-64.904-30.028-1.899-2.218-4.674-3.495-7.595-3.495h-43.182l-.059-103.902h43.196c2.927 0 5.706-1.282 7.606-3.508 16.281-19.075 39.95-30.016 64.937-30.016h1.658v.179c0 5.523 4.478 10 10 10h98.544c6.946 0 12.598 5.65 12.598 12.596s-5.651 12.597-12.598 12.597c-5.522 0-10 4.477-10 10s4.478 10 10 10h16.28c6.946 0 12.597 5.651 12.597 12.596.001 6.947-5.649 12.599-12.596 12.599z"/><path d="m243.334 175.618c5.849 5.848 13.53 8.772 21.212 8.772s15.363-2.924 21.212-8.772l48.812-48.812c11.696-11.696 11.696-30.728 0-42.424-11.697-11.695-30.727-11.695-42.424 0l-27.6 27.6-4.69-4.69c-11.697-11.695-30.727-11.695-42.424 0-5.666 5.666-8.786 13.199-8.786 21.212s3.12 15.546 8.786 21.212zm-11.76-54.183c1.949-1.949 4.509-2.923 7.069-2.923s5.121.975 7.069 2.923l11.762 11.761c3.906 3.905 10.236 3.905 14.143 0l34.671-34.671c3.898-3.898 10.24-3.898 14.139 0 1.889 1.888 2.929 4.399 2.929 7.069s-1.04 5.181-2.929 7.069l-48.812 48.812c-3.898 3.898-10.24 3.898-14.139 0l-25.902-25.902c-1.889-1.888-2.929-4.398-2.929-7.069s1.04-5.181 2.929-7.069z"/><path d="m191.148 55.143c2.561 0 5.122-.977 7.075-2.93 3.905-3.905 3.905-10.237 0-14.142-3.906-3.905-10.236-3.905-14.143 0l-.005.005c-3.905 3.905-3.902 10.234.003 14.139 1.953 1.952 4.512 2.928 7.07 2.928z"/></g></g></svg>
        </div>
        <div class="options-note">
            <div class="svg-container info" @click="showMoreModal(id,title)">
                <svg xmlns="http://www.w3.org/2000/svg" data-name="Layer 1" width="20" height="20" viewBox="0 0 128 128"><defs></defs><title>x</title><path class="cls-1" d="M63.99993,6.0564A57.9436,57.9436,0,1,0,121.9436,63.99993,58.00916,58.00916,0,0,0,63.99993,6.0564Zm0,104.44631a46.50272,46.50272,0,1,1,46.50278-46.50278A46.55537,46.55537,0,0,1,63.99993,110.50272Z"/><circle class="cls-2" cx="61.48833" cy="39.26524" r="7.74597"/><path class="cls-2" d="M56.41651,53.95439A4.60509,4.60509,0,0,0,52.616,58.48922h0a4.60348,4.60348,0,0,0,4.60463,4.60463H57.677V88.60052H55.21362a3.94011,3.94011,0,0,0-3.94011,3.94011h0a3.94011,3.94011,0,0,0,3.94011,3.94011H72.78638a3.94011,3.94011,0,0,0,3.94011-3.94011h0a3.94011,3.94011,0,0,0-3.94011-3.94011H70.34982V56.04026A3.97591,3.97591,0,0,0,65.60173,52.14C61.62628,52.92712,56.57417,53.92668,56.41651,53.95439Z"/></svg>
            </div>
            <div class="svg-container status" @click="changeStatus()">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24"><path d="M5.48 10.089l1.583-1.464c1.854.896 3.028 1.578 5.11 3.063 3.916-4.442 6.503-6.696 11.311-9.688l.516 1.186c-3.965 3.46-6.87 7.314-11.051 14.814-2.579-3.038-4.301-4.974-7.469-7.911zm14.407.557c.067.443.113.893.113 1.354 0 4.962-4.038 9-9 9s-9-4.038-9-9 4.038-9 9-9c1.971 0 3.79.644 5.274 1.723.521-.446 1.052-.881 1.6-1.303-1.884-1.511-4.271-2.42-6.874-2.42-6.075 0-11 4.925-11 11s4.925 11 11 11 11-4.925 11-11c0-1.179-.19-2.313-.534-3.378-.528.633-1.052 1.305-1.579 2.024z"/></svg>
            </div>
            <div class="svg-container color-picker" @click="colorPicker()">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24">
                    <linearGradient id="svg-color-picker">
                        <stop class="main-stop" offset="0%" />
                        <stop class="alt-stop" offset="100%" />
                    </linearGradient>
                    <path d="M18.896 7.104c-.682.6-.753 1.638-.153 2.324l-1.239 1.083-5.416-6.198 1.239-1.082c.599.684 1.638.753 2.32.154l3.246-2.776c.47-.407 1.048-.609 1.625-.609 1.38 0 2.482 1.128 2.482 2.471 0 .73-.322 1.393-.854 1.858l-3.25 2.775zm-6.943 3.896h-2.5l3.562-3.123-1.085-1.24-7.339 6.387c-1.189 1.033-.368 1.831-1.348 3.195-.133.186-.21.372-.231.55-.066.54.325.995.817 1.056.194.023.41-.015.616-.137 1.55-.912 2.178.117 3.396-.947l7.34-6.384-1.081-1.241-2.147 1.884zm-9.106 7.5c-.535 2.053-1.847 2.335-1.847 3.684 0 1.003.834 1.816 1.847 1.816s1.834-.813 1.834-1.816c0-1.349-1.299-1.631-1.834-3.684z"/>
                </svg>
            </div>
            <div class="u-overlay" :class="{active: isVisible}" @click="setPaletteStatus(false)"></div>
            <Palette v-show="isVisible" :idNote="id" @setPaletteStatus="setPaletteStatus"/>
            <div class="svg-container remove" @click="removeNote()">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24"><path d="M21 6l-3 18h-12l-3-18h2.028l2.666 16h8.611l2.666-16h2.029zm-4.711-4c-.9 0-1.631-1.099-1.631-2h-5.316c0 .901-.73 2-1.631 2h-5.711v2h20v-2h-5.711z"/></svg>
            </div>
        </div>
    </div>
</template>

<script>
import { ref, inject } from 'vue'
import notesStore from '../store/notes'
import Palette from './Palette'

export default {
    components: {
        Palette
    },
    props: {
        id: {
            type: Number
        },
        title: {
            type: String
        },
        color: {
            type: String
        },
        isCompleted: {
            type: Boolean
        }
    },
    setup(props) {
        let isVisible = ref(false)
        const emitter = inject("emitter")

        const showMoreModal = (id, title) => {
            emitter.emit("openModal", {id,title})
        }

        const removeNote = () => {
            notesStore.commit('removeNoteById', props.id)
        }

        const colorPicker = () => {
            isVisible.value = !isVisible.value
        }

        const setPaletteStatus = (status) => {
            isVisible.value = status
        }

        const changeStatus = () => {
            notesStore.commit('toggleStatus', props.id)
        }

        return {
            removeNote,
            colorPicker,
            isVisible,
            setPaletteStatus,
            showMoreModal,
            changeStatus,
        }
    }

}
</script>
